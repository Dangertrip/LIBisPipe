There are two ways to run LiBis:


If you want to run clipmode of LiBis, please change "-c 0" in command to "-c 1" 


1.Run it locally without docker:
In this mode, you will get faster computing speed, but the configuration is more complex.

Here's the steps:
    
    a.Install MOABS and make sure bsmap and mcall added to the PATH. You may run "bsmap" and "mcall" to check the availability.
      
      wget https://github.com/Dangertrip/LiBis/archive/master.zip
      unzip master.zip
      chmod +x LiBis-master/LIBisPipe
      conda install -c bioconda samtools=1.1

      bsmap and mcall are included in LiBis while it may not fit to your environment. Please check whether it works or not. If it doesn't fit your environment, please install it from: https://github.com/sunnyisgalaxy/moabs
      Please make sure samtools' version is 1.1.
      Please add LIBisPipe to $PATH to run the pipeline.

    b.Install Python3, conda and pip
      Python3 and conda can be downloaded and installed from https://www.anaconda.com/distribution/
      Please make sure than Python version is at least 3.6

      pip install -r LIBisPipe-master/requirements.txt
    
    c.Install Fastqc and make sure fastqc is added to the PATH.
      
      conda install -c bioconda fastqc

    d.Install bedtools

      conda install -c bioconda bedtools

    e.Install cutadapt and trim-galore

      conda install -c bioconda cutadapt
      conda install -c bioconda trim-galore

    f.Run LIBisPipe
    
      LIBisPipe -f 0 -n 6P1_notrim_val_1.fq.gz,6P2_notrim_val_2.fq.gz 6P1_notrim_val_1.fq.gz,6P2_notrim_val_2.fq.gz -c 0 -l s1 s2 -g hg19 -r hg19.fa -qc 1 -t 1
    

2.Run it with docker:

    Docker installation:
        https://docs.docker.com/v17.12/install/

    Check Docker availability:
        docker --version

    Prepare Docker instance:

        cd LIBisPipe/
        docker build --tag=libispipe ./
        docker run libispipe LIBisPipe --help
        ### Show help messages

        ### Testcase:

        docker run -v /path/to/yourdata:/data/ libispipe LIBisPipe -f 0 -n 6P1_notrim_val_1.fq.gz,6P2_notrim_val_2.fq.gz 6P1_notrim_val_1.fq.gz,6P2_notrim_val_2.fq.gz -c 0 -l s1 s2 -g hg19 -r hg19.fa -qc 1 -t 1 

        ### Please put reference and sample raw data under the dictionary you input.


Parameters in LiBis:

optional arguments:
  -h, --help            show this help message and exit
  -f FILE, --file FILE  Required. Enter a number, 0 means using parameter to
                        set up, 1 means using text file to set up
  -sf SETTINGFILE, --settingfile SETTINGFILE
                        Required. Setting txt file name. Ignore if -f is 0.
  -n [NAME [NAME ...]], --name [NAME [NAME ...]]
                        Required. Fastq file name.
  -c CLIP, --clip CLIP  Clip mode. 0 means close. 1 means open. default: 0
  -l [LABEL [LABEL ...]], --label [LABEL [LABEL ...]]
                        Required. Labels for samples
  -g GENOME, --genome GENOME
                        Required. Genome the reference belong to.(Use for
                        plotting) hg18/hg19/mm10/mm9 and so on. Plotting
                        script will not avaliable if leave it blank
  -w WINDOW, --window WINDOW
                        Window length for clipping mode, default=30
  -s STEP, --step STEP  Step size for clipping mode.
  -p PROCESS, --process PROCESS
                        Process using for one pipeline. Normally bsmap will
                        cost 8 cpu number. So total will be 8p.
  -r REF, --ref REF     Required. Reference
  -qc QUALITYCONTROL, --QualityControl QUALITYCONTROL
                        Do(1) quality control or not(0)
  -t TRIM, --trim TRIM  Do(1) trimming or not(0). Don't need to do trimming if
                        you use clip mode.
  -b BINSIZE, --binsize BINSIZE
                        Plot setting. Set the bin size for averaging
                        methylation ratio among samples, default=1000k
  -ft FILTER, --filter FILTER
                        filter for clipped reads
  -bam BAM, --bam BAM   Processed bam file for the first step. If bam files
                        are offered here, the first step of bsmap will be
                        skipped. BAM files can only be generated by BSMAP.
                        Different files should be seperated by ','. If there's
                        no bam file for part of the samples, leave the space
                        blank. For example: a.bam,b.bam,,,,f.bam

Update record:

Version 0.0.1
    1. Remove all part fastq/bam/sam. Merge all fragments into one file to speed up the computation.
    2. Extension requires the overlap between two fragments.
    2. Add -bam option to allow users use their own bam file for the first stage mapping.


